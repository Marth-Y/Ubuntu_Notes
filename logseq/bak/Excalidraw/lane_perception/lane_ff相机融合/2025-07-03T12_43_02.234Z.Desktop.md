---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠==


# Excalidraw Data

## Text Elements
将不同相机的线合并为一个vector ^7PXuz2TO

将线分为topo相关线集合、topo无关的线 ^bjSLiT76

里面也会简要用横向线线(未关联的线与已关联的线)的距离，判断线是否应该与关键点关联 ^h9gwLw7p

ClassifyByTopoRelationship ^KaeRuNkH

DropBad:遍历所有线，根据起点距离自车的距离，设定线长阈值，超过线长则采用 ^tn7mBcFN

MergeRebuildFeatlinesInterface(topo_points,input_featlines_put_in_one_cam,merged_featlines) ^NepaHHSx

1. ReadTopoIdsFromInputFeatlines ^gn6TNvRB

遍历所有单帧的线得到关联的topo点，将点从近到远排序，最多取三个：sorted_topo_ids ^6j0yq2XK

2. 将上述sorted_topo_ids映射为topo_id到线的map。作为关联topo点的线集合，每根线只会和一个TOPO点绑定 ^XDYDpI1A

3. 遍历观测的线，计算观测线与上述与topo点关联线的距离，距离近则认为也是关联的线 ^dzMqLx38

%%
## Drawing
```compressed-json
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
```
%%